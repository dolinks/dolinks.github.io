<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!--<![endif]-->

<head>
  <title>egret / 消除游戏笔记 | Dolink</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Dolink">
    <meta name="author" content="叛逆入伍">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="Dolink" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/categories/Blog/" target="_BLANK" class="animsition-link">Blog</a></li>
                    
                        <li><a href="/categories/Egret/" target="_BLANK" class="animsition-link">Egret</a></li>
                    
                        <li><a href="/categories/Draw/" target="_BLANK" class="animsition-link">Draw</a></li>
                    
                        <li><a href="/categories/Music/" target="_BLANK" class="animsition-link">Music</a></li>
                    
                </ul>
            </li>
            
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/Book/" class="animsition-link">Book<small>(1)</small></a></li>
				    
				    <li><a href="/categories/Draw/" class="animsition-link">Draw<small>(10)</small></a></li>
				    
				    <li><a href="/categories/Game/" class="animsition-link">Game<small>(1)</small></a></li>
				    
				    <li><a href="/categories/Java/" class="animsition-link">Java<small>(1)</small></a></li>
				    
				    <li><a href="/categories/WEB/" class="animsition-link">WEB<small>(1)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://go.kieran.top/" class="animsition-link">Kieran</a></li>
                    
                    <li><a href="http://xiaoxiangxiao.github.io/" class="animsition-link">肖翔</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">Dolink</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2018-05-16T08:24:55.000Z" itemprop="datePublished">
          2018-05-16
      </time>
    
    
    | 
    <a href='/tags/egret/'>egret</a>
    
    
</span>
                <h1>egret / 消除游戏笔记</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<p>基于A闪的消除游戏学习笔记，整理出整体开发流程陆续更新。</p>
<p>测试地址:<a href="https://dolinks.github.io/180525143357" target="_blank" rel="noopener">已经有了</a></p>
<h2 id="心得"><a href="#心得" class="headerlink" title="心得"></a>心得</h2><p>先把心得放到前边，学习东西总是体会最重要。以前从来没有写过游戏，对于内部的逻辑很多时候都是自己猜测去做，这个demo对于我来说，可能最大的意义是一个完整的去开发，从而理解做一个游戏用怎样的一个思路去写。<br>    先是分析游戏内部有哪些对象（元素）、角色、场景。对象有哪些属性，角色有哪些方法(或是动作，技能，物品)。场景有哪些类型（关卡），这些场景与对象之间的联系（比如说三个相同色的元素会消除）。通过这些方面的分析，能够帮助清楚代码中框架以及类如何设计。游戏中有专门处理数据的类、处理动画的类、还有控制器类、处理视图的类。我觉得分析程序往往是把东西拆分成独立的对象，从而细化对象的特性。在通过控制逻辑整理他们之间的关系。这样在遇到更为复杂的设计时才能清楚自己想什么，准备做什么。</p>
<h2 id="策划"><a href="#策划" class="headerlink" title="策划"></a>策划</h2><h2 id="核心算法"><a href="#核心算法" class="headerlink" title="核心算法"></a>核心算法</h2><h4 id="元素算法"><a href="#元素算法" class="headerlink" title="元素算法"></a>元素算法</h4><h4 id="道具算法"><a href="#道具算法" class="headerlink" title="道具算法"></a>道具算法</h4><p>主要封装了使用道具的方法，不同的道具类型调用对应的处理逻辑。</p>
<pre><code class="bash">class PropLogic {
public static useProp(proptype:number,ellocation:number){
        switch(proptype){
            <span class="keyword">case</span> 0:
            PropLogic.tongse(ellocation);
            <span class="built_in">break</span>;
            <span class="keyword">case</span> 1:
            PropLogic.zhadan(ellocation);
            <span class="built_in">break</span>;
            <span class="keyword">case</span> 2:
            PropLogic.zhenghang(ellocation);
            <span class="built_in">break</span>;
            <span class="keyword">case</span> 3:
            PropLogic.zhenglie(ellocation);
            <span class="built_in">break</span>;
            <span class="keyword">case</span> 4:
            PropLogic.chanzi(ellocation);
            <span class="built_in">break</span>;
        }
    }
}

</code></pre>
<h2 id="界面原型布局与算法"><a href="#界面原型布局与算法" class="headerlink" title="界面原型布局与算法"></a>界面原型布局与算法</h2><h4 id="界面原型"><a href="#界面原型" class="headerlink" title="界面原型"></a>界面原型</h4><img src="/2018/05/16/egret-eliminate-notes/WX20180516-163249.png" title="This is an example image">
<ul>
<li>紫色关卡条件：显示当前关卡需要消除多少元素，</li>
<li>剩余步数：剩余可移动步数</li>
<li>游戏区域：8*8方格</li>
<li>道具：显示所有道具与剩余数量</li>
</ul>
<img src="/2018/05/16/egret-eliminate-notes/WX20180516-163348.png" title="This is an example image">
<ul>
<li>head部分为绿色</li>
<li>背景图场景图（不同关卡背景图不一样）</li>
<li>道具栏目（5种道具，道具不为零为彩色，为零为不可用）</li>
</ul>
<h4 id="布局算法"><a href="#布局算法" class="headerlink" title="布局算法"></a>布局算法</h4><p>因为设备屏幕分辨率不同所以要对元素的生成进行运算。</p>
<p>元素宽度：(stageWidth-40）/8</p>
<img src="/2018/05/16/egret-eliminate-notes/WX20180516-163746.png" title="This is an example image">
<p>道具宽度：(StageWidth - 15 * 5) / 5<br><img src="/2018/05/16/egret-eliminate-notes/WX20180516-163827.png" title="This is an example image"></p>
<h4 id="性能界面拆分"><a href="#性能界面拆分" class="headerlink" title="性能界面拆分"></a>性能界面拆分</h4><p>优化Drawcall<br>cacheAsBitmap：不同图片合成一个大的纹理</p>
<h4 id="显示列表（场景控制）"><a href="#显示列表（场景控制）" class="headerlink" title="显示列表（场景控制）"></a>显示列表（场景控制）</h4><p>addChild：添加显示列表<br>RemoveChild：移除显示列表</p>
<p>Container：容器<br>    Stage：舞台（四种缩放模式）<br>    ScrollView：现实对象拖拽<br>    Sprite: 纯粹容器<br>bitmap：显示位图（）<br>bitmaptext：位图文本<br>TextField 文本<br>MovieClip：逐帧动画<br>Shape 适量绘图</p>
<p>九宫格：圆角矩形的位图拉伸（不会导致圆角矩形拉伸变形）</p>
<h4 id="Event类"><a href="#Event类" class="headerlink" title="Event类"></a>Event类</h4><h4 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h4>
            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="m-pagination col-md-8 col-md-offset-2 col-sm-24" role="pagination">
    
    <a class="pull-left" href="/2018/05/31/draw-hand/" style="float: left;">
        ← 手素描，随便来的
    </a>
    
    
    <a class="pull-right" href="/2018/05/15/draw-magnolia-flower/">
        手绘/线稿/玉兰花 →
    </a>
    
</nav>

        <div class="col-md-8 col-md-offset-2 col-sm-24"><script type="text/javascript">
  /**
   * 搜狐畅言
   */

  /*
  document.write('<div id="SOHUCS" sid="' + window.location.pathname.slice(1) + '" ></div>');

  window.onload = function () {
    (function () {
      var appid = 'cytXXXX';
      var conf = 'prod_xxxxxxxxxxxxxxxxx';
      var width = window.innerWidth || document.documentElement.clientWidth;
      var loadJs = function (d, a, id) {
        var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
        var b = document.createElement("script");
        b.setAttribute("type", "text/javascript");
        b.setAttribute("charset", "UTF-8");
        b.setAttribute("src", d);
        if (id) {
          b.setAttribute("id", id);
        }
        if (typeof a === "function") {
          if (window.attachEvent) {
            b.onreadystatechange = function () {
              var e = b.readyState;
              if (e === "loaded" || e === "complete") {
                b.onreadystatechange = null;
                a()
              }
            }
          } else {
            b.onload = a
          }
        }
        c.appendChild(b)
      };

      loadJs("https://changyan.sohu.com/upload/changyan.js", function () {
        window.changyan.api.config({
          appid: appid,
          conf: conf
        })
      });
    })();
  }
  */

</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By 叛逆入伍. All Rights Reserved.
                </p>
                <p>
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
</p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



      
</body>
</html>
